(self.modernJsonp=self.modernJsonp||[]).push([["12724"],{659182(e,t,r){r.d(t,{A:()=>o});var n=r(601185),i=r(844255),a=r(971289);function o(){let{isAuthenticated:e}=(0,i._8)(),t=(0,a.M)(),{checkExperiment:r}=(0,n.A)();return{mWebCloseupRedesignEnabled:e&&t&&r("mweb_closeup_redesign").anyEnabled,mWebCloseupRedesignExpGroup:r("mweb_closeup_redesign").group}}},458345(e,t,r){r.d(t,{A:()=>p});var n=r(679902),i=r(432321),a=r(427471),o=r(435108),s=r(457315),l=r(81920),d=r(676692),c=r(121066),u=r(399952);let p=function(){let e=(0,i.A)();if(e?.isAuthenticated&&!function(){let e=(0,i.A)(),t=window.location.pathname.startsWith("/settings/notifications"),r=window.location.pathname.startsWith("/reports-and-violations/"),n=window.location.pathname.startsWith("/email/subscription")||window.location.pathname.startsWith("/email/remove")||t,a=window.location.pathname.startsWith("/pin/create/"),o="/pin-builder/"===window.location.pathname&&/url=/.test(window.location.href),{userAgent:s}=e||{userAgent:{isMobile:!1,isTablet:!1}};return s.isMobile||s.isTablet?n||r:a||o||n||r}()){let{viewType:t,viewParameter:r}=(0,d.Cs)()??{},i=(0,c.uy)(window),p=e.experimentsClient.checkExperiment("web_metrics_retry_count").anyEnabled;!function(e,t,r=!1){if(r){let r=0,n=3e4,i=()=>{a.A.create("ActiveUserResource",e).callCreate().catch(a=>{let d,c=a.message;if(c&&"object"==typeof c){"_t_message"in c&&delete c._t_message;try{d=JSON.stringify(c)}catch(e){d="Unable to serialize error message"}}else d=c;(0,l.GV)("webapp.metrics.dau.errors",{sampleRate:1,tags:{message:d,browser:e.data.browser,error_code:(0,s.A)(a,"api_error_code")||"unknown",is_auth:t}}),setTimeout(()=>{n>o.Qv||(n*=2,r+=1,e.data.auxData.event_retry_count=r,i())},n)})};i()}else{let r=a.A.create("ActiveUserResource",e),n=3e4;r.callCreate().catch(i=>{let a,d=i.message;if(d&&"object"==typeof d){"_t_message"in d&&delete d._t_message;try{a=JSON.stringify(d)}catch(e){a="Unable to serialize error message"}}else a=d;(0,l.GV)("webapp.metrics.dau.errors",{sampleRate:1,tags:{message:a,browser:e.data.browser,error_code:(0,s.A)(i,"api_error_code")||"unknown",is_auth:t}}),setTimeout(()=>{n>o.Qv||(n*=2,r.callCreate())},n)})}}({data:{appVersion:(0,u.A)(),auxData:{pwa_type:i&&"unknown"!==i?i:void 0,stage:e.stage??"unknown"},browser:e.userAgent.browserType,clientUUID:(0,n.A)(),event_type:7137,time:1e6*Date.now(),unauth_id:e.unauthId,view_type:t,view_parameter:r}},e.isAuthenticated,p)}}},326550(e,t,r){function n(e){return[0,24,21,26].includes(e)}function i({articleType:e,id:t,title:r}){let n=r.toLowerCase().replace(/[.,\/#!?$%\^&\*+;:{}=\-_`~()\â€™'"]/g,"").trim().replace(/\s+/g,"-");return"today"===e?`/today/shop/${n}/${t}/`:`/discover/article/${n}/${t}/`}r.d(t,{I:()=>n,k:()=>i})},431802(e,t,r){r.d(t,{E2:()=>n,I0:()=>l,KU:()=>p,N9:()=>a,Rv:()=>o,X9:()=>i,Yl:()=>u,hh:()=>d,t8:()=>s});let n=e=>{let t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t&&[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]},i=(e,t,r)=>.2126*(e/255)**2.2+.7151*(t/255)**2.2+.0721*(r/255)**2.2,a=e=>{let t=e.replace("#","");return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3<155},o=({hexColor:e,saturationMultiplier:t,brightnessMultiplier:r,minSaturationClamp:i,mixVal:a=1,minBrightnessClamp:o=0})=>{let s=n(e);null===s&&(s=[229,229,224]);let l=((e,t,r)=>{let n=Math.max(e/=255,t/=255,r/=255),i=n-Math.min(e,t,r),a=0;return 0!==i&&(a=(n===e?(t-r)/i+6*(t<r):n===t?(r-e)/i+2:(e-t)/i+4)*60)<0&&(a+=360),{h:a,s:0===n?0:i/n,b:n}})(...s),d=(e,t,r)=>Math.max(t,Math.min(e,r));l.s=d(l.s*(1+t),i,1),l.b=d(l.b*(1+r),o,1);let c=(({h:e,s:t,b:r})=>{let n=r*t,i=n*(1-Math.abs(e/60%2-1)),a=r-n,o=0,s=0,l=0;return e<60?(o=n,s=i):e<120?(o=i,s=n):e<180?(s=n,l=i):e<240?(s=i,l=n):e<300?(o=i,l=n):(o=n,l=i),{r:Math.round((o+a)*255),g:Math.round((s+a)*255),b:Math.round((l+a)*255)}})({...l}),u=e=>({r:Math.round(c.r*a+e*(1-a)),g:Math.round(c.g*a+e*(1-a)),b:Math.round(c.b*a+e*(1-a))}),p=u(0),h=u(255);return[[p.r,p.g,p.b],[h.r,h.g,h.b]]};function s(e){if("string"!=typeof e)return{r:0,g:0,b:0,a:0};let t=e.trim(),r="rgba"===t.slice(0,4).toLowerCase(),n=!r&&"rgb"===t.slice(0,3).toLowerCase();if(!r&&!n)return{r:0,g:0,b:0,a:0};let i=t.indexOf("("),a=t.indexOf(")",i);if(-1===i||-1===a)return{r:0,g:0,b:0,a:0};let o=t.slice(i+1,a).split(",").map(e=>e.trim());if(r&&4!==o.length||n&&3!==o.length)return{r:0,g:0,b:0,a:0};let[s,l,d,c]=o,u=Number(s),p=Number(l),h=Number(d),m=r?Number(c):1;return[u,p,h].some(e=>Number.isNaN(e))||r&&Number.isNaN(m)?{r:0,g:0,b:0,a:0}:{r:u,g:p,b:h,a:m}}function l(e,t){let r=e.a+t.a*(1-e.a);return 0===r?{r:0,g:0,b:0,a:0}:{r:Math.round((e.r*e.a+t.r*t.a*(1-e.a))/r),g:Math.round((e.g*e.a+t.g*t.a*(1-e.a))/r),b:Math.round((e.b*e.a+t.b*t.a*(1-e.a))/r),a:r}}let d=e=>`rgba(${e.r}, ${e.g}, ${e.b}, ${e.a})`,c=e=>e.toString(16).padStart(2,"0"),u=(e,t)=>{let r=n(e);if(!r)throw Error(`Invalid hex color: ${e} for lightenHexByPercentage`);let[i,a,o]=r,s=Math.max(0,Math.min(100,t))/100,l=Math.round(i+(255-i)*s),d=Math.round(a+(255-a)*s),u=Math.round(o+(255-o)*s);return`#${c(l)}${c(d)}${c(u)}`},p=(e,t)=>d(((e,t)=>{let r=n(e);if(!r)throw Error(`Invalid hex color: ${e} for hexToRgba`);let[i,a,o]=r;return{r:i,g:a,b:o,a:Math.max(0,Math.min(1,t))}})(e,t))},470820(e,t,r){r.d(t,{A:()=>l});var n=r(61163),i=r(859471),a=r(150880),o=r(194046),s=r(562615);function l({carouselData:e,contextLogData:t,height:r,id:l,index:d,slideWidth:c,view:u,impressionType:p,viewParameter:h}){(0,i.useEffect)(()=>{(0,n.A)("CarouselImpressionItem","/app/packages/gestaltExtensions/Carousel/CarouselImpressionItem.tsx")},[]);let[m,_]=(0,i.useState)(null),[f,g]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{m!==d?(_(d),g(!1)):g(!0)},[d,m]),e)?(0,s.jsx)(o.oc,{carouselData:{...e,type:"canonical"},contextLogData:t,impressionType:p??"Pin",isPaused:!f,loggingId:l,slotIndex:d,viewParameter:h,viewType:u,children:({impressionTrackerRef:e})=>(0,s.jsx)(a.az,{ref:e,"data-test-id":`carousel-impression-ref-${l}-${d}`,height:r,overflow:"hidden",position:"absolute",width:c})},`carousel-impression-key-${d}`):null}},275272(e,t,r){r.d(t,{A:()=>h});var n=r(61163),i=r(859471),a=r(150880),o=r(659182),s=r(201593),l=r(123576);let d="0px 0px 8px rgba(0, 0, 0, 0.1)";var c=r(844255),u=r(535494),p=r(562615);function h({children:e,footerConfig:t,headerConfig:r,height:h,hideOnScroll:m,hideOnScrollState:{isHidden:_,updateHiddenState:f},isFooterHidden:g,noPadding:x,paddingX:b,paddingY:v=3,type:y,zIndex:w,isStoryPin:A}){let S,P;(0,i.useEffect)(()=>{(0,n.A)("FixedContent","/app/packages/layout/FixedContent.tsx")},[]);let{headerLimitedOverflow:j,ignoreObstructions:I,zIndexForGestaltBug:k}=r||{},{appUpsellFooterConfig:C,footerInLego:T,navFooterConfig:E}=t||{},z=!!C,M="header"===y?"top":"bottom",{isDarkMode:R}=(0,s.D2)(),{isRTL:L}=(0,c._8)(),{mWebCloseupRedesignEnabled:H}=(0,o.A)(),D=(0,i.useRef)(null),O=(0,i.useRef)(null);(0,i.useEffect)(()=>{try{if(!I){let e=D.current;O.current=j&&e&&Array.isArray(e.children)?e.children[0]:e,O.current instanceof HTMLElement&&l.A.addObstruction(M,O.current)}}catch(e){window.console.error(e),window.console.error('Can only register impression obstructions for type "HTMLElement"')}return()=>{!I&&O.current instanceof HTMLElement&&l.A.removeObstruction(M,O.current)}},[I,j,M,R]);let N="top"===M?"relative":"fixed",B=x?0:v,U=(h??64)+(r?.overrideTop||0),$=m||E?{transition:T||H?"transform 300ms ease-in-out, opacity 300ms ease-in-out":"transform 200ms linear",..._||g?{transform:`translateY(${"top"===M?-U:U}px)`,opacity:T||H?0:1}:Object.freeze({})}:{},F=2*!("relative"!==N||r?.noGutter),W=F?-F:0,V=R?s.ee:"rgba(255,255,255,.95)";R&&("header"===y?S=-1:P=-1);let J=T?z?void 0:h??64:"100%",Y=r?.isTranslucent&&V||R?V:"var(--sema-color-background-default)",G=r?.isTransparentBackground&&1?"var(--sema-color-background-transparent)":Y,q=(0,i.useMemo)(()=>({height:"footer"===y&&H?`calc(${J} + env(safe-area-inset-bottom))`:J,...H&&"footer"===y?{paddingBottom:`calc(env(safe-area-inset-bottom) + ${4*(B||0)}px)`}:Object.freeze({})}),[H,J,y,B]),K=(0,u.A)({skipExpActivation:!0});return(0,p.jsx)(a.az,{ref:D,bottom:"footer"===y,dangerouslySetInlineStyle:{__style:{top:S,bottomStyle:P,...!w||k?{zIndex:k||1}:Object.freeze({}),...j?{background:"transparent",overflow:"hidden",paddingBottom:100,marginBottom:-100,pointerEvents:"none"}:Object.freeze({}),...r?.hasBorder?{borderBottom:"1px solid #efefef"}:Object.freeze({}),...t?.hasTopShadow?{boxShadow:"0 -2px 4px 1px rgba(0, 0, 0, 0.08)"}:Object.freeze({}),...$}},"data-test-id":y,display:z?"flex":void 0,height:h&&!T?h:void 0,left:!0,marginEnd:T?"auto":W,marginStart:T?"auto":W,onTransitionEnd:()=>{(m||E)&&O.current&&(_||g?l.A.removeObstruction(M,O.current):l.A.addObstruction(M,O.current))},position:N,right:!0,top:"header"===y,width:T||"fixed"!==N?void 0:"100%",zIndex:k?void 0:w,children:(0,p.jsx)(a.az,{alignItems:t?.alignCenter?"center":void 0,dangerouslySetInlineStyle:{__style:{backgroundColor:G,paddingLeft:L||!K||A?void 0:"8px",paddingRight:L&&K&&!A?"8px":void 0,...q,boxShadow:H&&"footer"===y?`0 10px 0 0 ${G}, ${d}`:T?d:void 0,marginBottom:T&&!E?.docked?16:void 0,...j?{pointerEvents:"auto"}:Object.freeze({}),...r?.useRoundedCorners?{zIndex:5,borderTopRightRadius:17,borderTopLeftRadius:17,borderBottomRightRadius:0,borderBottomLeftRadius:0}:Object.freeze({})}},display:T||t?.alignCenter?"flex":void 0,marginEnd:T?"auto":void 0,marginStart:T?"auto":void 0,paddingX:b||4*("footer"===y&&!x)+F,paddingY:B,position:"relative",rounding:T&&!E?.docked?"pill":void 0,width:E?E.footerWidth:z?void 0:"100%",children:"function"==typeof e?e({updateHiddenState:f}):e})})}},303196(e,t,r){r.r(t),r.d(t,{default:()=>d});var n=r(61163),i=r(859471),a=r(150880),o=r(275272),s=r(292225),l=r(562615);function d({hasBorder:e,headerLimitedOverflow:t,ignoreObstructions:r,isTranslucent:d,isTransparentBackground:c,noGutter:u,overrideTop:p,useRoundedCorners:h,zIndexForGestaltBug:m,isStoryPin:_,...f}){(0,i.useEffect)(()=>{(0,n.A)("FixedHeader","/app/packages/layout/FixedHeader.tsx")},[]);let{noPadding:g,paddingY:x=3,zIndex:b}=f;return(0,l.jsx)(a.ib,{height:t?44+2*(g?0:x)*4:void 0,top:p||0,zIndex:b||void 0,children:(0,l.jsx)(s.A,{hideOnScroll:f.hideOnScroll,children:n=>(0,l.jsx)(o.A,{...f,headerConfig:{isTranslucent:d,isTransparentBackground:c,headerLimitedOverflow:t,hasBorder:e,ignoreObstructions:r,noGutter:u,overrideTop:p,zIndexForGestaltBug:m,useRoundedCorners:h},hideOnScrollState:n,isStoryPin:_,type:"header"})})})}},292225(e,t,r){r.d(t,{A:()=>o});var n=r(859471),i=r(284966);function a(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class o extends n.Component{constructor(...e){super(...e),a(this,"state",{isHidden:!!this.props.appUpsellFooterConfig||!!this.props.navFooterConfig?.isDockedNavOnPlp}),a(this,"lastScrollPos",0),a(this,"updateHiddenState",e=>{this.reqAnimationId=window.requestAnimationFrame(()=>{this.setState({isHidden:e})})}),a(this,"handleScroll",(0,i.A)(()=>{let{appUpsellFooterConfig:e,navFooterConfig:t}=this.props,{isHidden:r}=this.state,n=window.scrollY,i=n-this.lastScrollPos,a="none",{scrollHeight:o,clientHeight:s}=document.documentElement||{};Number.isNaN(o)||Number.isNaN(s)||(a=i<0?n<=Math.abs((window.scrollMinY||0)+Math.max(i,20))?"start":"none":n>=(window.scrollMaxY||o-s)-Math.max(i,20)?"end":"none");let l=55*!t?.isModal;e?i>20&&r&&n>=500?e.shouldShowAfterScroll()&&(this.updateHiddenState(!1),t?.onScroll(!1)):(i<-20&&!r||n<=l)&&(this.updateHiddenState(!0),t?.onScroll(!0)):this.props.navFooterConfig?.isDockedNavOnPlp?"start"===a&&!r||n<=l?(this.updateHiddenState(!0),t?.onScroll(!0)):(n>l||"end"===a)&&r&&(this.updateHiddenState(!1),t?.onScroll(!1)):(i<-20||"start"===a)&&r||n<=l?(this.updateHiddenState(!1),t?.onScroll(!1)):(i>20||"end"===a)&&!r&&(this.updateHiddenState(!0),t?.onScroll(!0)),this.lastScrollPos=n},30))}componentDidMount(){try{(this.props.hideOnScroll||this.props.navFooterConfig?.isDockedNavOnPlp)&&window.addEventListener("scroll",this.handleScroll)}catch(e){window.console.error(e),window.console.error('Can only register impression obstructions for type "HTMLElement"')}}componentWillUnmount(){(this.props.hideOnScroll||this.props.navFooterConfig?.isDockedNavOnPlp)&&window.removeEventListener("scroll",this.handleScroll),this.reqAnimationId&&(window.cancelAnimationFrame(this.reqAnimationId),this.reqAnimationId=null)}componentDidUpdate(e){!e.hideOnScroll&&this.props.hideOnScroll||!e.navFooterConfig?.isDockedNavOnPlp&&this.props.navFooterConfig?.isDockedNavOnPlp?(this.updateHiddenState(!0),window.addEventListener("scroll",this.handleScroll)):(e.hideOnScroll&&!this.props.hideOnScroll||e.navFooterConfig?.isDockedNavOnPlp&&!this.props.navFooterConfig?.isDockedNavOnPlp)&&(this.updateHiddenState(!1),window.removeEventListener("scroll",this.handleScroll))}render(){let{children:e,navFooterConfig:t}=this.props,{isHidden:r}=this.state;return e({isHidden:!t?.forceShow&&r,updateHiddenState:this.updateHiddenState})}}},131321(e,t,r){r.d(t,{A:()=>n});function n(e,t){return t in e}},161916(e,t,r){r.d(t,{A:()=>d});var n=r(859471),i=r(106386),a=r(810972),o=r(212244),s=r(120649);let l=(e,t,r)=>e.resources[t]?.[r];function d(e){let{name:t,optionsKey:r}=e??{name:"",optionsKey:""},d=t===o.W,c=(0,s.uN)(),u=c?.get(t,r);if(u)throw u;let p=(0,a.createSelector)(e=>l(e,t,r),e=>e?.data),h=(0,a.createSelector)(e=>l(e,t,r),e=>e?.auxData),m=(0,a.createSelector)(e=>l(e,t,r),e=>e?.error),_=(0,a.createSelector)(e=>l(e,t,r),e=>e?.nextBookmark),f=(0,i.d4)(_),g=(0,i.d4)(p),x=(0,i.d4)(h),b=(0,i.d4)(m),v=(0,n.useRef)({auxData:void 0,data:void 0,error:void 0,isAtEnd:!1,nextBookmark:void 0});if(d)return v.current;let y={auxData:x,data:g,error:b,isAtEnd:"-end-"===f,nextBookmark:f};return(y.auxData!==v.current.auxData||y.data!==v.current.data||y.error!==v.current.error||y.isAtEnd!==v.current.isAtEnd||y.nextBookmark!==v.current.nextBookmark)&&(v.current=y),v.current}},485321(e,t,r){r.d(t,{A:()=>n});let n=(0,r(859471).createContext)("u">typeof window?window:null)},805863(e,t,r){r.d(t,{A:()=>a});var n=r(457315),i=r(752159);function a(){let e=navigator.serviceWorker;return e&&e.getRegistration?((0,i.PM)("mweb_service_worker.unregister_attempt"),e.getRegistration().then(e=>{if(e)return e.unregister().then(()=>((0,i.PM)("mweb_service_worker.unregister_success"),navigator.serviceWorker&&window.caches?window.caches.keys().then(e=>{let t=e.find(e=>e.startsWith("workbox-precaching"));return t?window.caches.delete(t):null}).then(()=>(0,i.PM)("mweb_service_worker.clear_app_shell")):Promise.resolve())).catch(e=>{(0,i.fu)("mweb_service_worker.unregister_fail",{error:(0,n.A)(e,"message")})})})):Promise.resolve()}},733048(e,t,r){r.d(t,{A:()=>n});function n(e){switch(e){case -1:return null;case 0:return"shopping-bag";case 1:return"tag";case 9:return"clock-history";default:return"magnifying-glass"}}},987055(e,t,r){r.d(t,{A:()=>n});function n(e,t){if(!t)return e;let r=new RegExp(/http(s?):/);if(!r.test(e)){let n=r.exec(t);n&&n.length&&(e=n[0]+e)}return e}},385800(e,t,r){r.d(t,{A:()=>o,e:()=>a});var n=r(859471);let i=()=>{let[e,t]=(0,n.useState)(!1),[r,i]=(0,n.useState)(!1),[a,o]=(0,n.useState)(!1);return{active:e,focused:r,hovered:a,onBlur:()=>{i(!1),t(!1)},onFocus:()=>i(!0),onMouseDown:()=>t(!0),onMouseEnter:()=>o(!0),onMouseLeave:()=>{o(!1),t(!1)},onMouseUp:()=>t(!1)}};function a({children:e}){return e(i())}let o=i},310065(e,t,r){r.d(t,{o:()=>d,p:()=>l});var n=r(859471),i=r(987628),a=r(652567),o=r(562615);let{Provider:s,get:l}=(0,i.A)("LastSavedTo");function d({children:e}){let[t,r]=(0,n.useState)();(0,a.jY)("BoardPickerBoardsShortlistResource",e=>{if(!t){let{data:t}=e.response.resource_response;r(t)}});let i=(0,n.useCallback)(e=>{let n=t?t.filter(t=>t.id!==e.id):[];r([e,...n])},[t]),l=(0,n.useMemo)(()=>({lastSavedTo:t,saveToBoard:i}),[t,i]);return(0,o.jsx)(s,{value:l,children:e})}},878913(e,t,r){r.d(t,{P:()=>n,y:()=>i});let{Provider:n,getMaybe:i}=(0,r(987628).A)("PinCreateDeleteContext")},463530(e,t,r){r.d(t,{A:()=>S});var n=r(61163),i=r(859471),a=r(150880),o=r(154508),s=r(971987),l=r(586733),d=r(296221),c=r(470820),u=r(538329),p=r(726329),h=r(131094),m=r(542975),_=r(844255),f=r(168079),g=r(678358),x=r(562615);function b({index:e,length:t,showBadge:r}){return(0,i.useEffect)(()=>{(0,n.A)("CarouselBadge","/app/www/common/Carousel/CarouselBadge.tsx")},[]),(0,x.jsx)(a.az,{alignItems:"center",color:"selected",dangerouslySetInlineStyle:{__style:{opacity:80*!!r,transition:"opacity .3s"}},display:"flex",height:35,justifyContent:"center",marginEnd:5,marginTop:5,position:"absolute",right:!0,rounding:200,width:35,zIndex:new a.rk(1),children:(0,x.jsx)(a.KJ,{color:"inverse",children:`${(e??0)+1}/${t}`})})}var v=r(381786),y=r(699613),w=r(788446);let A=`
  .horizontal-scroll-container {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  ::-webkit-scrollbar {
    display: none;
  }`;function S(e){let t;(0,i.useEffect)(()=>{(0,n.A)("Carousel","/app/www/common/Carousel/Carousel.tsx")},[]);let{backgroundColor:r="transparent",children:S,componentType:P,containerRef:j,contextLogData:I,disableTransition:k,gap:C=0,height:T,id:E,impressionType:z,index:M,responsiveSizing:R=!1,shouldBeDragCarousel:L,showCarouselBadge:H,styleOverrides:D,innerCarouselWidthRef:O,slideWidth:N,surface:B,paddingX:U,view:$,viewParameter:F,widthRatio:W=1,setSlideIndex:V,sliderRef:J,showCarouselOverflow:Y,isHorizontalScrollable:G}=e,{showBadge:q}=(({index:e})=>{let[t,r]=(0,i.useState)(!0),n=(0,i.useRef)(void 0),a=(0,i.useRef)(void 0);return(0,i.useEffect)(()=>(n.current=setTimeout(()=>{r(!1)},3e3),()=>{clearTimeout(n.current)}),[]),(0,i.useEffect)(()=>{if(!a.current){a.current=e;return}clearTimeout(n.current),r(!0)},[e]),{showBadge:t}})({index:M}),{logContextEvent:K}=(0,l.o)(),X=(0,y.HR)()(E),Q=(0,u.A)(),{isRTL:Z}=(0,_._8)(),ee=(0,i.useRef)(void 0),et=(0,i.useRef)(null),er=(0,i.useRef)(0),en=(0,i.useRef)(void 0),ei=(0,w.A)(),{peekCloseupEnabled:ea,viewportSize:eo}=(0,g._G)();if((0,f.A)(()=>{let e=et.current;if(!e)return;J&&e&&(J.current=e);let t=()=>{let e=er.current;if(G){let t=new IntersectionObserver(([r])=>{let n=-(r.boundingClientRect.x??0),a=i.Children.toArray(S),o=J?(0,v.jV)(J.current,n+ei,N,W,C,a.length):0;V?.(o),Math.abs(e-n)>=10&&K({aux_data:{...I},component:P,event_type:"right"==(e<n?"right":"left")?9315:9316,view_type:$,view_parameter:F}),er.current=n,en.current&&t.unobserve(en.current)});en.current&&t.observe(en.current)}else{let t=-(en.current?.getBoundingClientRect().x??0);Math.abs(e-t)>=10&&K({aux_data:{...I},component:P,event_type:"right"==(e<t?"right":"left")?9315:9316,view_type:$,view_parameter:F}),er.current=t}};return L&&(G&&e?.addEventListener("scroll",t),e?.addEventListener("touchend",t)),()=>{L&&(G&&e?.removeEventListener("scroll",t),e?.removeEventListener("touchend",t))}}),W>1||W<0)throw Error("widthRatio should be between 0 and 1 inclusive");let es=Math.floor(N*W),el=i.Children.toArray(S),ed=el.length*es,ec=j?.clientWidth||ed,{maxHeight:eu,fiftyPercentHeight:ep,fiftyPercentWidth:eh}=(0,o.Vc)(),em=ea&&"lg"===eo&&"ShoppingGridSmallCarousel"===B;ea&&(t="sm"===eo?ep:eu);let e_=D?.justifyContent??(ec>ed?"center":"start"),ef=e=>void 0!==e?`${e}px`:L?"8px":void 0,eg=ef(D?.horizontalScrollContainerPaddingLeft),ex=ef(D?.horizontalScrollContainerPaddingRight);O&&(O.current="center"===e_?et.current:null);let eb=R||L?void 0:(0,v.oz)({slotWidth:es,gap:C,numberOfSlides:el.length,index:M,containerWidth:ec,paddingX:U});return(0,x.jsxs)("div",{className:"BoardMoreIdeasRep"===z?"moreIdeasBoardRepCarousel":"",style:R?{height:"inherit"}:{},children:[(0,x.jsxs)(a.az,{alignItems:"center","data-test-id":"carousel-pin",display:"flex",height:R?"inherit":void 0,justifyContent:e_,overflow:em||Y?void 0:"hidden",children:[H&&(0,x.jsx)(b,{index:M,length:el.length,showBadge:q}),"BoardMoreIdeasRep"!==z&&(0,x.jsx)(s.P,{pinKey:null!=X?{type:"Legacy",data:X}:null,children:e=>(0,x.jsx)(c.A,{carouselData:{...e,type:"canonical"},contextLogData:I,height:T??ee.current?.clientHeight??1,id:E,impressionType:"Pin",index:M,slideWidth:N,view:$??1,viewParameter:F??72},`carousel-impression-key-${M}`)}),L&&(0,x.jsx)(h.A,{unsafeCSS:A}),(0,x.jsx)("div",{ref:et,className:"horizontal-scroll-container","data-test-id":"carousel-container",style:{backgroundColor:r,overflowX:L?"scroll":"visible",paddingLeft:eg,paddingRight:ex,display:"flex",flexDirection:D?.flexDirection??"row",height:R?"inherit":void 0,marginLeft:U?`${U}px`:void 0,marginRight:U?`${U}px`:void 0,position:"relative",scrollbarWidth:0,transition:L||k?void 0:Z?"right .5s":"left .5s",right:Z?eb:void 0,left:Z?void 0:eb,width:R?"100%":void 0},children:el.map((e,r)=>{let n=r===el.length-1,i=Math.ceil(C/4),s=0;i>=-12&&i<=12&&(s=i);let l=(0,x.jsx)(a.az,{ref:e=>{ee.current=e,0===r&&(en.current=e)},"aria-label":(0,m.$)(Q._('Slide {{ currentSlide }} of {{ totalSlides }}', 'CloseupCarousel.Carousel.labelSlide', 'Accessibility label that defines a carousel slide. currentSlide: current slide number. totalSlides: total number of slides in carousel.'),{currentSlide:`${r+1}`,totalSlides:`${el.length}`}),"data-carousel-indicator":"carousel-card","data-test-id":`carousel-img-${r}`,display:r!==M&&R?"none":"block",height:R?"100%":T??void 0,marginEnd:n?0:s,maxHeight:t,maxWidth:em?`calc(${o.aP}px - ${o.T3}px * 2)`:eh,role:"group",width:R?"100%":es,children:e},`carousel-slot-${E}-${r}`);if("BoardMoreIdeasRep"===z){let t=e.props,n={total_object_count:t?.story.objects?.length??0,storyType:t?.story.story_type,boardIdStr:t?.item.board_id,slotIndex:t?.slotIndex,story_id:t?.story.id};return(0,x.jsx)(p.g$,{componentType:P,contextLogData:n,impressionAuxFields:n,impressionType:"BoardMoreIdeasRep",loggingId:E,slotIndex:r,viewParameter:F??72,viewType:$??1,children:({impressionTrackerRef:e})=>(0,x.jsx)(a.az,{ref:e,children:l})},`carousel-slot-${E}-${r}`)}return l})})]}),14114===P&&(0,x.jsx)(d.En,{anchor:en.current,experienceIds:[506684],idealDirection:"down",placementId:11,positionRelativeToAnchor:!0,showCaret:!0,textWeight:"normal",useMasonryFlyout:!0})]})}},823284(e,t,r){r.d(t,{A:()=>l});var n=r(61163),i=r(859471),a=r(150880),o=r(538329),s=r(562615);let l=({iconType:e,showFab:t,moduleHovered:r,opacity:l=80})=>{(0,i.useEffect)(()=>{(0,n.A)("NavigationFab","/app/www/common/Carousel/NavigationFab.tsx")},[]);let d=(0,o.A)(),[c,u]=(0,i.useState)(!1),p=r??c;return(0,s.jsx)(a.az,{"data-test-id":"navigation-fab-container",onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),opacity:p?100:p===r?0:l,children:(0,s.jsx)(a.az,{dangerouslySetInlineStyle:{__style:{transition:"opacity 0.3s linear"}},opacity:100*!!t,children:(0,s.jsx)(a.K0,{accessibilityLabel:"forward"===e?d._('View Next', 'Button to advance carousel to the next image', 'Button to advance carousel to the next image'):d._('View Previous', 'Button to advance carousel to the previous image', 'Button to advance carousel to the previous image'),bgColor:"default",dataTestId:"navigation-fab",icon:"forward"===e?"chevron-right":"chevron-left",size:"md"})})})}},381786(e,t,r){r.d(t,{JF:()=>s,Jf:()=>a,KJ:()=>o,UV:()=>u,WD:()=>d,jV:()=>c,oz:()=>i,tS:()=>l});let n=({containerWidth:e,contentWidth:t,index:r,slotAndGapWidth:i})=>{let a=r-1,o=a*i;return t-o>=e?o:n({index:a,slotAndGapWidth:i,containerWidth:e,contentWidth:t})},i=({containerWidth:e,gap:t,index:r,numberOfSlides:i,slotWidth:a,paddingX:o})=>{let s=a+t,l=s*i,d=o?e-o:e;if(l<=d)return 0;let c=d/s,u=(({index:e,numberOfSlides:t,slidesShownPerPosition:r})=>t-e-Math.floor(r)<1)({index:r,numberOfSlides:i,slidesShownPerPosition:c})?(({containerWidth:e,contentWidth:t,gap:r,index:i,slidesShownPerPosition:a,slotAndGapWidth:o,paddingX:s=0})=>n({containerWidth:e,contentWidth:t,index:i,slotAndGapWidth:o})+(({slidesShownPerPosition:e,slotAndGapWidth:t})=>t-(e-parseInt(e,10))*t)({slidesShownPerPosition:a,slotAndGapWidth:o})-r+s)({containerWidth:d,contentWidth:l,gap:t,index:r,slidesShownPerPosition:c,slotAndGapWidth:s,paddingX:o}):r*s;return u?Math.round(-u):0},a=({containerWidth:e,gap:t,index:r,numberOfSlides:n,slotWidth:a,isHorizontalScrollable:o,paddingX:s,rows:l=1})=>{let d=n/l*a+t*(n-1),c=s?e-s:e;return 0!==e&&(d<=c||(o?d<=c:Math.abs(i({containerWidth:e,gap:t,index:r,numberOfSlides:n,slotWidth:a,paddingX:s}))+t>=d-c))},o=({containerWidth:e,currentIndex:t,gap:r,index:n,numberOfSlides:a,slotWidth:o,paddingX:s})=>{let l=o+r,d=s?e-s:e;if(l*a<=d||0===e)return!0;let c=i({containerWidth:e,gap:r,index:t,numberOfSlides:a,slotWidth:o,paddingX:s}),u=s?d+l+s:e+l;return c+l*n<u},s=(e,t,r)=>e||`${t._('carousel image', 'Alternate text for a carousel image that indicates it is a carousel pin, with carousel index followed', 'Alternate text for a carousel image that indicates it is a carousel pin, with carousel index followed')} ${r}`;function l({highResOnly:e,slot:t}){let{images:r}=t;return e?`${r?.["564x"]?.url??""} 1x`:[r?.["474x"]&&`${r["474x"].url??""} 2x`,r?.["736x"]&&`${r["736x"].url??""} 3x`,r?.orig&&`${r.orig.url??""} 4x`].filter(Boolean).join(", ")}let d=(e,t,r,n,i=0,a)=>{let o=a?r-a:r;if(o===t)return-(n*t*1)+(a||0);let s=Math.floor(o-t),l=t+i;return n===e-1?-1*n*l+s+(a||0):-1*n*l+(a||0)},c=(e,t,r,n,i,a,o)=>{if(!e||t<=0)return 0;let s=Math.floor(r*n),l=e?.clientWidth||a*s;return Math.round(((o?t-o:t)+(o?l-o:l)-s/2)/(s+i))-1},u=(e,t,r,n,i,a)=>{e.current&&t&&e.current.scrollBy({left:(r-n)*(i+a),behavior:"smooth"})}},636171(e,t,r){r.d(t,{A:()=>eO});var n=r(61163),i=r(859471),a=r(106386),o=r(979638),s=r(150880),l=r(706114),d=r(458345),c=r(668014),u=r(296221),p=r(358203),h=r(586733),m=r(671996),_=r(678863),f=r(845126),g=r(173095),x=r(538329),b=r(81920),v=r(562615);let y=({display_data:e,complete:t,dismiss:r,context_aux_data:n})=>{let a=(0,x.A)(),{logContextEvent:o}=(0,h.o)(),[l,d]=(0,i.useState)(!0),[c,u]=(0,i.useState)(0),p=()=>{d(!1),r()},y=(0,i.useCallback)((e,t)=>{o({event_type:e,component:15489,element:t,aux_data:{experience_id:n.experience_id,placement_id:n.placement_id,step_number:c+1,step_index:c}})},[n.experience_id,n.placement_id,c,o]);if((0,i.useEffect)(()=>{y(13,18257)},[c,y]),!l)return null;if(!(e.steps&&e.steps.length>0&&e.steps.every(e=>e.title&&e.subtitle&&e.primary_button&&e.image)))return(0,b.GV)(m.pv,{sampleRate:1,tags:{experience_id:n.experience_id,placement_id:n.placement_id,reason:"Required display data not present",platform:4}}),null;let w=e.steps[c];if(!w)return(0,b.GV)(m.pv,{sampleRate:1,tags:{experience_id:n.experience_id,placement_id:n.placement_id,reason:`No step for index ${c}`,platform:4}}),null;let A=window?.innerWidth||375,S=(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)(s.ib,{top:0,children:(0,v.jsx)(s.az,{padding:3,position:"absolute",width:"100%",children:(0,v.jsx)(s.K0,{accessibilityLabel:a._('Dismiss', 'experiences.ExperienceModalWindow.modalDismissIconButton', 'Accessibility label for the X icon button to dismiss the modal window'),bgColor:"washLight",icon:"close",iconColor:"default",onClick:()=>{y(123,75),p()},size:"lg"})})}),(0,v.jsx)(s.iX,{contentAspectRatio:.8,height:1.25*A,width:A,children:(0,v.jsx)(s._V,{alt:w.image.image_alt,color:w.image.dominant_color||void 0,fit:"cover",naturalHeight:w.image.height,naturalWidth:w.image.width,src:w.image.url})})]}),P=(0,v.jsxs)(s.az,{alignItems:"center",display:"flex",flex:"grow",justifyContent:"center",paddingX:2,paddingY:3,children:[w.secondary_button&&(0,v.jsx)(_.A,{buttonType:"secondary",data:(0,f.q)(w.secondary_button,()=>{y(102,13005),p()}),experienceSchema:2}),(0,v.jsx)(_.A,{buttonType:"primary",data:(0,f.q)(w.primary_button,()=>{c<e.steps.length-1?(y(102,13004),u(c+1)):t()}),experienceSchema:2})]});return(0,v.jsx)(g.A,{accessibilityModalLabel:a._('Multi Step Modal', 'experiences.ExperienceMultiStepModal.accessibilityModalLabel', 'Accessibility label for the multi step modal'),allowClickAndDrag:!1,footer:P,header:S,isOpen:l,mobileIsSlideUp:!0,onDismiss:()=>{y(123,16412),p()},size:"auto",children:(0,v.jsxs)(s.az,{padding:3,children:[(0,v.jsx)(s.az,{marginBottom:3,children:(0,v.jsx)(s._Y,{size:"500",children:w.title})}),(0,v.jsx)(s.KJ,{children:w.subtitle})]})})};function w({experience:e}){return(0,i.useEffect)(()=>{(0,n.A)("ExperienceMultiStepModal","/app/packages/experiences/Experiences/ExperienceMultiStepModal/ExperienceMultiStepModal.tsx")},[]),(0,v.jsx)(u.Je,{eligibleSchemas:[2],eligibleTypes:[26],experience:e,children:({complete:t,dismiss:r,experience:{display_data:n}})=>(0,v.jsx)(y,{complete:t,context_aux_data:{experience_id:e?.experience_id,placement_id:e?.placement_id},dismiss:r,display_data:n})})}var A=r(171768),S=r(777275),P=r(567176),j=r(693154),I=r(303196),k=r(214429),C=r(41206),T=r(601185),E=r(844255),z=r(430705),M=r(618243),R=r(328582),L=r(998556),H=r(319571),D=r(706466),O=r(803489),N=r(971289),B=r(720575),U=r(807782),$=r(825179),F=r(439524),W=r(694804);r(487688);var V=r(743372),J=r(168079),Y=r(328673);let G={__style:{textOverflow:"ellipsis",whiteSpace:"nowrap"}};function q({currentTabIndex:e,tabBoards:t}){(0,i.useEffect)(()=>{(0,n.A)("MoreIdeasTabs","/app/www/Homefeed/MoreIdeasTabs.tsx")},[]);let r=(0,i.useRef)(null),l=(0,i.useRef)(!1),d=(0,i.useRef)([]),c=(0,o.Zp)(),u=(0,x.A)(),p=(0,V.A)(),h=(0,a.wA)(),m=t.length?[{href:"/",text:(0,v.jsx)(s.az,{children:u._('All', 'homefeed.moreIdeasTab.homefeedTab', 'Homefeed tab')}),tabType:1},...t.filter(e=>e).map(({id:e,name:t},r)=>({href:`/?boardId=${String(e)}`,text:(0,v.jsx)(s.az,{dangerouslySetInlineStyle:G,maxWidth:100,overflow:"hidden",children:t}),boardId:e,tabType:2,ref:d.current[r]}))]:null;if((0,J.A)(()=>{d.current=Array(t.length).fill(void 0).map((e,t)=>d.current[t]||(0,i.createRef)())}),(0,i.useEffect)(()=>()=>{l.current&&(window.cancelAnimationFrame(l.current),l.current=null)}),!m)return null;let _=m.map(e=>({href:e.href,text:e.text,ref:e.ref}));return(0,v.jsx)(s.az,{ref:r,"data-test-id":"more-ideas-tabs",fit:!0,marginBottom:1,marginTop:1,overflow:"scrollX",children:(0,v.jsx)(s.tU,{activeTabIndex:e,onChange:({activeTabIndex:e})=>{let r=m?.[e];if(r){let n;n=r.boardId,h((0,Y.Y)(n,e));let i=1===r.tabType?u._('All', 'homefeed.moreIdeasTab.homefeedTab', 'Homefeed tab'):t.find(e=>e.id===r.boardId)?.name;p({event_type:101,view_type:1,view_parameter:92,component:13184,element:1===r.tabType?11081:11082,aux_data:{index:e.toString(),board_id:r.boardId,referrer:19,tab_title:i},object_id_str:r.boardId})}let{pathname:n,state:i}=m?{pathname:(m[e]||m[0]).href,state:(m[e]||m[0]).locationState||void 0}:{};c(n,{state:i})},tabs:_})})}var K=r(765346),X=r(273919),Q=r(863265),Z=r(593936),ee=r(242978),et=r(284247),er=r(996209),en=r(809756),ei=r(499053),ea=r(699613);let eo=new s.rk(100);function es({pinUrl:e,inviter:t}){(0,i.useEffect)(()=>{(0,n.A)("NuxSharedPinBanner","/app/www/pages/duplo/NuxSharedPinBanner.tsx")},[]);let r=(0,x.A)(),o=(0,ea.HR)(),[l,d]=(0,i.useState)(!0),c=(0,a.wA)(),u=()=>c((0,ei.A)(null,null)),p=(0,er.A)(e),{data:h}=(0,z.A)({name:"PinResource",options:{id:p,field_set_key:"detailed",is_mobile_fork:!0}}),m=p?o(p):null,_=h??m,f=_?.image_medium_url??_?.image_large_url,g=t.first_name??t.full_name??t.username??"",b=(0,et.A)(r._('Tell {{ name }} what you think', 'HomePage.SharedPinBannerTitle', 'Shared pin banner title. name: inviter\'s display name'),{name:g}),{navFooterHeight:y}=(0,en.o)();return p&&_&&g&&f&&l?(0,v.jsx)(s.az,{marginBottom:2,marginTop:2,paddingX:2,children:(0,v.jsx)(s.vF,{message:r._('See what inspired them and reply with your thoughts', 'HomePage.SharedPinBanner.Subtext', 'Subtext for shared pin banner'),offset:{bottom:y+8,top:0},onDismiss:()=>{u(),d(!1)},primaryAction:{href:e+"&hide_app_upsell=true",label:r._('See Pin', 'HomePage.SharedPinToastAction', 'CTA to view shared pin'),accessibilityLabel:r._('See shared Pin', 'HomePage.SharedPinToastAction.accessibilityLabel', 'Accessibility label for CTA to view shared pin'),onClick:u,role:"link"},secondaryAction:{accessibilityLabel:r._('Later', 'HomePage.SharedPinBannerSecondary.accessibilityLabel', 'Dismiss shared pin banner'),label:r._('Later', 'HomePage.SharedPinBannerSecondary', 'Secondary action to dismiss shared pin banner'),onClick:()=>{u(),d(!1)},role:"button"},thumbnail:{image:(0,v.jsx)(s._V,{alt:"Shared Pin",color:"transparent",fit:"cover",naturalHeight:40,naturalWidth:40,src:f})},title:b,zIndex:eo})}):null}function el(){(0,i.useEffect)(()=>{(0,n.A)("PreferencesUpdatedBanner","/app/www/pages/duplo/PreferencesUpdatedBanner.tsx")},[]);let{shouldRefreshHomefeed:e,clearRefreshFlag:t}=(0,Z.d)(),{showToast:r}=(0,D.CG)(),a=(0,x.A)(),o=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{if(e&&!o.current){o.current=!0;let e=a._('Preferences updated! We\'re refreshing your feed now.', 'PreferencesUpdatedBanner.message', 'Message shown when user returns to homefeed after updating preferences');r(({hideToast:r})=>(0,v.jsx)(P.A,{duration:3e3,onHide:()=>{r(),t(),o.current=!1},text:e}))}else e||(o.current=!1)},[e,t,r,a]),null}var ed=r(623987),ec=r(408738);function eu(e,t,r){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let ep=(0,ec.A)(()=>r.e("82269").then(r.bind(r,922453)),void 0,e=>922453,"app-www-pages-duplo-CoreActionsHeader",e=>["82269"]),eh=(0,ec.A)(()=>r.e("65469").then(r.bind(r,497826)),void 0,e=>497826,"app-www-stories-FullWidthPinStory",e=>["65469"]),em=(0,ec.A)(()=>r.e("11757").then(r.bind(r,50812)),{ssr:!1},e=>50812,void 0,void 0),e_=(0,ec.A)(()=>r.e("30764").then(r.bind(r,907748)),void 0,e=>907748,"app-www-Homefeed-HomefeedMoreIdeasTabContent",e=>["30764"]),ef=(0,ec.A)(()=>r.e("45231").then(r.bind(r,827279)),void 0,e=>827279,"app-www-stories-LandingPageStory-LandingPageStory",e=>["45231"]),eg=(0,ec.A)(()=>Promise.all([r.e("18324"),r.e("46782"),r.e("49412")]).then(r.bind(r,945101)),{ssr:!1},e=>945101,void 0,void 0),ex=(0,ec.A)(()=>Promise.all([r.e("43744"),r.e("99233")]).then(r.bind(r,308344)),{ssr:!1},e=>308344,void 0,void 0),eb=(0,ec.A)(()=>r.e("93920").then(r.bind(r,626531)),{ssr:!1},e=>626531,void 0,void 0),ev=(0,ec.A)(()=>Promise.all([r.e("91796"),r.e("28081")]).then(r.bind(r,668008)),{ssr:!1},e=>668008,void 0,void 0),ey=(0,i.lazy)(()=>r.e("98325").then(r.bind(r,757876))),ew=(0,i.lazy)(()=>r.e("72022").then(r.bind(r,21589))),eA=(0,i.lazy)(()=>r.e("39634").then(r.bind(r,92041))),eS=(0,i.lazy)(()=>r.e("41334").then(r.bind(r,64469))),eP=(0,i.lazy)(()=>r.e("9106").then(r.bind(r,286441))),ej=(0,i.lazy)(()=>r.e("99062").then(r.bind(r,562773))),eI={feedKey:ee.bg,trafficSource:ee.mA,resourceName:ee.jC,feedItemProps:e=>({viewParameter:92,viewType:1,onFeedItemClick:()=>{e.onFeedItemClick&&e.onFeedItemClick()}}),pullToRefresh:!0},ek={first_page_size:"25",page_size:"10"},eC=({webMobileHomeFeedTakoverExperience:e})=>{let{feedKey:t,feedItemProps:r,pullToRefresh:n}=eI,i=(0,o.zy)(),d=(0,o.Zp)(),c=(0,a.d4)(({session:e})=>e.firstHomeFeedRequestAfterNux),u={webMobileHomeFeedTakoverExperience:e,location:i,navigate:d},p=(0,a.d4)(({feeds:e})=>e[t]??[]),{selectedUseCases:h,selectedPins:m}=(0,Q.p)(),_=(0,K.xx)(h,m),f=!c,g=_.length>0?{in_nux:c,nux_signals_map:_}:{in_nux:c},x={...ee.Vf,...f?{...ek}:{...g},in_local_navigation:!0,static_feed:!!(i&&(i.pathname.includes("pwt_performance_testing")||void 0!==(0,O.A)(i.search).pwt_performance_testing))},y=(0,z.A)({name:ee.jC,options:x}),{isAtEnd:w,isFetching:A,fetchMore:S,data:P,refresh:j}=y,I={includeBackgroundImages:!0,includeVideos:!0,pins:Object.values((0,ea.zy)())};c&&(0,b.GV)("home_product.homefeed.has_in_nux_flag",{sampleRate:.1,tags:{appType:"mweb"}});let k=(()=>{let{isGraphQLEnabledInGeneral:e}=(0,U.aR)(),{locale:t}=(0,E._8)(),r=(0,ea.zy)();return({feedItems:n,prevFeedItems:i,finishedRefresh:a,unauthLandingPinStateForAuthHomefeed:{pinId:o,feedItem:s}})=>{if(!n.length)return null;if(a&&i.length>0){let e=(e,t)=>e.slice(0,t).map(e=>e.id),r=e(i,5),a=e(n,5),o={appType:"mweb",language:t&&t.slice(0,2)||"unknown",locale:t||"unknown"};(0,b.GV)("home_product.homefeed.refresh",{sampleRate:1,tags:o}),JSON.stringify(r)===JSON.stringify(a)&&(0,b.GV)("home_product.homefeed.refresh.no_change",{sampleRate:1,tags:o})}if(o&&!e){if(i.length>0&&i[0]!==n[0])return(0,L.y1)().removeItem(l.sH),{feedItem:null,pinId:null};else if((0===i.length||i[0]===n[0]&&i.length!==n.length||!s)&&r[o]&&!n.slice(0,5).some(({id:e})=>e===o))return{feedItem:{id:o,type:"pin",trackingParams:n[0].trackingParams},pinId:o}}return null}})(),C=P?.length?P[0]:null;if(e&&e.display_data?.in_checklist_education&&e.display_data?.num_columns_requested===2){let e={type:"fullWidthBreakIn",value:{index:0,content:C?.id&&(0,v.jsx)(ed.A,{storyId:C.id,children:e=>(0,v.jsx)(eh,{slotIndex:0,story:e,viewParameter:3833,viewType:604})})}},i=p.slice(1);return(0,v.jsx)(s.az,{"data-test-id":"homefeed",children:(0,v.jsx)($.RM,{authHomefeedComponentDidUpdate:k,feedItemProps:r&&r(u),feedItems:i,feedItemsAdjustment:e,feedKey:t,pagination:{hasNext:!w,isLoadingNext:A,loadNext:()=>S(),refetch:()=>j()},pullToRefresh:n,trafficSource:ee.mA,visuallyCompleteProfilerOptions:I})})}return f&&!e?.display_data?(0,v.jsx)(s.az,{"data-test-id":"homefeed-ssr",children:(0,v.jsx)($.Ir,{authHomefeedComponentDidUpdate:k,feedItemProps:r&&r(u),feedKey:ee.bg,pullToRefresh:n,resource:y,serverRender:!0,trafficSource:ee.mA,visuallyCompleteProfilerOptions:I})}):(0,v.jsx)(s.az,{"data-test-id":"homefeed",children:(0,v.jsx)($.Ir,{authHomefeedComponentDidUpdate:k,feedItemProps:r&&r(u),feedKey:t,pullToRefresh:n,resource:y,trafficSource:ee.mA,visuallyCompleteProfilerOptions:I})})},eT=(0,ec.A)(()=>r.e("79716").then(r.bind(r,785327)),{ssr:!1},e=>785327,void 0,void 0),eE=(0,ec.A)(()=>r.e("83602").then(r.bind(r,413609)),{ssr:!1},e=>413609,void 0,void 0),ez=(0,ec.A)(()=>r.e("42948").then(r.bind(r,830255)),{ssr:!1},e=>830255,void 0,void 0),eM=(0,ec.A)(()=>r.e("78449").then(r.bind(r,153096)),{ssr:!1},e=>153096,void 0,void 0),eR=(0,ec.A)(()=>r.e("13099").then(r.bind(r,411206)),{ssr:!1},e=>411206,void 0,void 0),eL=(0,ec.A)(()=>r.e("78416").then(r.bind(r,256403)),{ssr:!1},e=>256403,void 0,void 0);class eH extends i.PureComponent{constructor(...e){super(...e),eu(this,"state",{...(0,K.of)(),currentTabIndex:"number"==typeof this.props.selectedTabIndex?this.props.selectedTabIndex:0,showUnlinkTokenExpiredModal:!1,showDeleteAccountSurveyModal:!1,showYipModal:!1,shouldDismissCoreActionsHeader:!1,showQRAppErrorBanner:!1}),eu(this,"renderOptInInterestPicker",()=>{let{everythingFeedExperience:e,isLimitedLogin:t}=this.props,{extraPlpImages:r,extraBlpImages:n}=this.state,i=!t&&e&&504192===e.experience_id,a=i&&e&&e.display_data&&e.display_data.full_screen_modal;return e&&i?(0,v.jsx)(c.A,{name:"SafeSuspense_HomePage_OptInInterestPicker",children:a?(0,v.jsx)(eL,{experience:e,extraImageInfo:r.length>0?r:n,viewParameter:92,viewType:1}):(0,v.jsx)(eM,{experience:e,viewParameter:92,viewType:1})}):null})}static getDerivedStateFromProps(e){let{selectedTabIndex:t,navigate:r,location:n}=e;return(0,O.A)(n.search).show_qr_app_error?(r("/",{replace:!0}),{showQRAppErrorBanner:!0}):"number"==typeof t?{currentTabIndex:t}:null}componentDidMount(){let{dispatchViewedSharedPins:e,location:t,i18n:r,showToast:n,navigate:i}=this.props,{sharedPinData:a}=this.state;(0,X.h)(!1),(0,d.A)(),a&&Object.keys(a).length>0&&e(a),t.state?.unlinkTokenInvalid&&this.setState({showUnlinkTokenExpiredModal:!0}),t.state?.isCloseAccountReasonOpen&&this.setState({showDeleteAccountSurveyModal:!0}),t.state?.showError&&n(({hideToast:e})=>(0,v.jsx)(P.A,{duration:5e3,onHide:e,text:r._('We can\u2019t find that idea! Try searching for one just like it.', ' - ', ' -- '),type:"error"})),(0,O.A)(t.search).show_yip_modal&&(i("/",{replace:!0}),this.setState({showYipModal:!0})),this.props.shouldRefreshHomefeed&&(0,F.Y9)("homefeed")}render(){let{checkExperiment:e,currentUserId:t,currentUsername:r,everythingFeedExperience:n,navigate:a,i18n:o,isAuthenticated:l,isEligibleForCoreActionsHeader:d,isPartner:h,location:m,moreIdeasStory:_,newUserWelcomeStoryExperience:f,webMobileHomeFeedTakoverExperience:g,selectedTabBoardId:x,tabBoards:b,shouldRefreshHomefeed:y}=this.props,{currentTabIndex:P,showUnlinkTokenExpiredModal:j,showDeleteAccountSurveyModal:C,showYipModal:T,shouldDismissCoreActionsHeader:E,showQRAppErrorBanner:z}=this.state,L=(0,O.A)(m.search),D=L&&L.boardId||x;if(n&&!z)switch(n.experience_id){case 40002:case 10105:return(0,v.jsx)(c.A,{name:"SafeSuspense_HomePage_Nux",children:(0,v.jsx)(M.A,{fallback:(0,v.jsx)(R.A,{accessibilityLabel:this.props.i18n._('Loading new user education', 'Loading spinner', 'Loading spinner')}),children:h?(0,v.jsx)(ez,{experience:n}):(0,v.jsx)(eE,{experience:n})})});case 500681:return(0,v.jsx)(c.A,{name:"SafeSuspense_HomePage_ContactUpdate",children:(0,v.jsx)(eT,{fallback:(0,v.jsx)(R.A,{accessibilityLabel:this.props.i18n._('Loading experience', 'loading experience spinner', 'loading experience spinner')})})})}let N=l&&e("mweb_hf_core_actions_header").anyEnabled&&d,U=()=>{this.setState({shouldDismissCoreActionsHeader:!0})};return(0,v.jsx)(B.A,{viewParameter:92,viewType:1,children:(0,v.jsx)(H.A,{view:1,viewParameter:92,children:(0,v.jsxs)(k.default,{dataLayoutShiftBoundaryId:"AuthHomePageContainer",hasFixedHeader:!0,children:[z&&(0,v.jsx)(s.az,{marginTop:4,children:(0,v.jsx)(ej,{})}),this.props.sessionSharedPinLandingInfo?.url&&this.props.sessionSharedPinLandingInfo?.inviter&&this.props.checkExperiment("ce_mweb_nux_shared_pin_banner").anyEnabled?(0,v.jsx)(es,{inviter:this.props.sessionSharedPinLandingInfo.inviter,pinUrl:this.props.sessionSharedPinLandingInfo.url}):null,(0,v.jsx)(W.A,{text:o._('Home', 'HomePage.HiddenAccessibilityHeader', 'Accessibility h1 at home page')}),!!b?.length&&(0,v.jsx)(I.default,{hideOnScroll:l,noPadding:!0,overrideTop:0,children:(0,v.jsx)(s.az,{paddingY:1,children:(0,v.jsx)(q,{currentTabIndex:P,tabBoards:b||[]})})}),_&&(0,v.jsx)(s.az,{marginEnd:-4,marginStart:-4,paddingY:2,children:(0,v.jsx)(ed.A,{storyId:_.id||"",children:e=>(0,v.jsx)(eh,{slotIndex:0,story:e,viewParameter:92,viewType:1},_.id)})}),0!==P&&D&&P<=(b?.length??0)&&(0,v.jsx)(e_,{boardId:D})||(0,v.jsxs)(i.Fragment,{children:[(0,v.jsx)(w,{experience:n}),(0,v.jsx)(u.Vj,{experience:n,placementId:40001}),(0,v.jsx)(u.nU,{placementId:40001}),(0,v.jsx)(u.aR,{experience:n,placementId:40001}),(0,v.jsx)(p.A,{placementId:n?.placement_id}),(0,v.jsx)(S.A,{placementId:1000544}),(0,v.jsx)(A.A,{placementId:1000558}),(0,v.jsx)(u.Je,{eligibleIds:[500726,500866,500735,500833,501182,501275,501385,501358,501908,501909,503291],experience:n,children:(0,v.jsx)(M.A,{children:(0,v.jsx)(ew,{experience:n})})}),n&&(0,v.jsx)(u.Je,{eligibleIds:[507483],experience:n,children:({dismiss:e,experience:{display_data:t}})=>{let r=!("is_blocking"in t)||t.is_blocking;return(0,v.jsx)(eg,{container:"HomePage",dismiss:e,isBlockingModal:r})}}),n&&(0,v.jsx)(u.Je,{eligibleIds:[507661],experience:n,children:({dismiss:e,experience:{display_data:t}})=>(0,v.jsx)(ex,{container:"HomePage",displayData:t,onDismiss:e})}),n&&(0,v.jsx)(u.Je,{eligibleIds:[507924],experience:n,children:({complete:e,dismiss:t})=>(0,v.jsx)(eb,{onComplete:e,onDismiss:t})}),n&&(0,v.jsx)(u.Je,{eligibleIds:[508387],experience:n,placementId:40001,children:({complete:e,dismiss:t,experience:r})=>(0,v.jsx)(ev,{complete:e,dismiss:t,experience:r})}),n&&(0,v.jsx)(u.Je,{eligibleIds:[505326],experience:n,children:({complete:e,dismiss:t})=>(0,v.jsx)(i.Suspense,{children:(0,v.jsx)(eP,{complete:e,dismiss:t})})}),n&&(0,v.jsx)(u.Je,{eligibleIds:[505801],experience:n,children:({complete:e})=>(0,v.jsx)(i.Suspense,{children:(0,v.jsx)(eS,{complete:e})})}),f?.display_data?.story&&f.display_data.showUpdatedLandingPageStory&&(0,v.jsx)(ef,{isMoreIdeasTabsVisible:!!b?.length,newUserWelcomeStoryExperience:f}),(0,v.jsxs)(s.az,{marginTop:2*(!b?.length&&!_),children:[!E&&N&&(0,v.jsx)(ep,{onDismiss:U,username:r||""}),(0,v.jsx)(eC,{webMobileHomeFeedTakoverExperience:g})]})]}),j&&(0,v.jsx)(M.A,{children:(0,v.jsx)(s.az,{"data-test-id":"unlink-expired-token",children:(0,v.jsx)(eA,{onDismiss:()=>{a("/",{replace:!0}),this.setState({showUnlinkTokenExpiredModal:!1})}})})}),C&&(0,v.jsx)(M.A,{children:(0,v.jsx)(ey,{isPartner:h,onDismiss:()=>{a("/",{replace:!0}),this.setState({showDeleteAccountSurveyModal:!1})},userId:t,username:r})}),T&&(0,v.jsx)(c.A,{name:"YearInPreviewConfirmPublishModal",children:(0,v.jsx)(eR,{onModalDismiss:()=>{this.setState({showYipModal:!1})}})}),this.renderOptInInterestPicker(),0===P&&n&&(0,v.jsx)(u.Je,{eligibleIds:[508418],experience:n,children:()=>y?(0,v.jsx)(el,{}):(0,v.jsx)(em,{hasTabBoards:(b?.length??0)>0})})]})})})}}let eD=[];function eO(){(0,i.useEffect)(()=>{(0,n.A)("HomePage","/app/www/pages/duplo/HomePage.tsx")},[]);let e=(0,x.A)(),t=(0,a.wA)(),r=(0,j.A)(),{showToast:s}=(0,D.CG)(),l=(0,o.Zp)(),d=(0,o.zy)(),{checkExperiment:c}=(0,T.A)(),{shouldRefreshHomefeed:p,clearRefreshFlag:h}=(0,Z.d)(),{experience:m}=(0,u.Rf)(40001),{experience:_}=(0,u.Rf)(1000115),{experience:f}=(0,u.Rf)(1000411),g=(0,a.d4)(({feeds:e})=>e.homefeed),b=(0,a.d4)(({homefeedTabUI:e})=>e.activeTabBoardId),y=(0,a.d4)(({homefeedTabUI:e})=>e.activeTabIndex),{isAuth:w,isLimitedLogin:A}=r,S=(0,a.d4)(({session:e})=>e.firstHomeFeedRequestAfterNux),P=(0,a.d4)(({session:e})=>e.sharedPinLandingInfo??null),I=r.isAuth?r.id:void 0,k=r.isAuth?r.username:void 0,E=!!r.isAuth&&r.isPartner,M=(0,N.qJ)(),R=Array.isArray(g)?g:[],L=!M&&R[0]&&"story"===R[0].type?R[0]:null,H=(0,a.d4)(({stories:e})=>L?e[L.id]:null),O=H&&H.story_type&&H.story_type.startsWith("boards_more_ideas_feed_upsell")?H:null,B=R.find(({type:e})=>"home_feed_tabs"===e)?.tabs,{data:U}=(0,z.A)(w&&c("mweb_hf_core_actions_header",{dangerouslySkipActivation:!0}).anyEnabled?{name:"UserResource",options:{user_id:r.id,field_set_key:"core_actions_header"}}:null),$=(0,N.M)();(0,C.A)(d,s,e);let F={checkExperiment:c,currentUserId:I,currentUsername:k,dispatchViewedSharedPins:e=>t({type:"SET_VIEWED_SHARED_PINS",payload:{pins:e}}),everythingFeedExperience:m,navigate:l,i18n:e,isAuthenticated:w,isEligibleForCoreActionsHeader:U?.is_eligible_for_core_actions_header,isLimitedLogin:A,isMobile:$,isPartner:E,location:d,moreIdeasStory:O,newUserWelcomeStoryExperience:f,selectedTabBoardId:b,selectedTabIndex:y,showToast:s,tabBoards:B??eD,webMobileHomeFeedTakoverExperience:_,shouldRefreshHomefeed:p,clearRefreshFlag:h,inNux:S,sessionSharedPinLandingInfo:P};return(0,v.jsx)(eH,{...F})}},242978(e,t,r){r.d(t,{Vf:()=>s,bg:()=>i,jC:()=>o,ks:()=>l,mA:()=>a});var n=r(788332);let i="homefeed",a="feed_home",o="UserHomefeedResource",s={field_set_key:"mobile_grid_item",prepend:!1},l=(0,n.A)(s)},328673(e,t,r){r.d(t,{Y:()=>n});let n=(e,t)=>({type:"SET_ACTIVE_HOMEFEED_TAB",payload:{boardId:e,index:t}})},499053(e,t,r){r.d(t,{A:()=>n});function n(e,t){return{type:"SET_SHARED_PIN_LANDING_INFO",payload:{url:e,inviter:t}}}},676130(e,t,r){r.d(t,{J3:()=>a,X2:()=>s,e6:()=>o,tj:()=>l});var n=r(586733),i=r(257300);let a=(e,t)=>({type:"TOPIC_FOLLOW",payload:{id:e,value:t}}),o=(e,t,r)=>async n=>{n(a(e,!0));try{await (0,i.A)({url:"/v3/users/{user}/interests/favorited/{interest}/",urlParams:{user:"me",interest:e},method:"PUT",data:{image_size:1,fields:["interest.images[300x300(ir.24)]","interest.name"],referrer:r}}),t({event_type:601,object_id_str:e})}catch(t){n(a(e,!1))}},s=(e,t,r)=>async n=>{n(a(e,!1));try{await (0,i.A)({url:"/v3/users/{user}/interests/favorited/{interest}/",urlParams:{user:"me",interest:e},method:"DELETE",data:{referrer:r}}),t({event_type:602,object_id_str:e})}catch(t){n(a(e,!0))}},l=(e,t="",r)=>async o=>{await (0,i.A)({url:"/v3/users/interests/synchronize/",method:"PUT",data:{referrer:t,updated_interest_follows:JSON.stringify(e)}}),Object.keys(e).forEach(t=>{let r=e[t];o(a(t,r))}),(r??(0,n.o)().logContextEvent)({event_type:615})}},987093(e,t,r){r.d(t,{AD:()=>m,X2:()=>u,e6:()=>d,sN:()=>c,x2:()=>p});var n=r(257300),i=r(974694);function a(e,t){return(0,n.A)({url:"/v3/users/{followee}/follow/",urlParams:{followee:e},method:"PUT",data:t?{invite_code:t}:{}})}function o(e){return(0,n.A)({url:"/v3/users/{followee}/follow/",urlParams:{followee:e},method:"DELETE"})}let s=(e,t,r,n)=>{let a=t().session?.userId;e((0,i.pV)(r,n)),a&&e((0,i.yX)(a,n))},l=(e,t,r,n)=>{s(e,t,r,!n)};function d(e,t=null,r,n,i){return(o,d)=>{s(o,d,e,!0),a(e,i).then(()=>{r({event_type:45,object_id_str:e,aux_data:t?{pin_id:t}:void 0,clientTrackingParams:n??void 0})}).catch(()=>{l(o,d,e,!0)})}}function c(e,t=null,r,n,i){return async(o,d)=>{s(o,d,e,!0);try{await a(e,i),r({event_type:45,object_id_str:e,aux_data:t?{pin_id:t}:void 0,clientTrackingParams:n??void 0})}catch(t){throw l(o,d,e,!0),t}}}function u(e,t=null,r,n){return(i,a)=>{s(i,a,e,!1),o(e).then(()=>{r({event_type:46,object_id_str:e,aux_data:t?{pin_id:t}:void 0,clientTrackingParams:n??void 0})}).catch(()=>{l(i,a,e,!1)})}}function p(e,t=null,r,n){return async(i,a)=>{s(i,a,e,!1);try{await o(e),r({event_type:46,object_id_str:e,aux_data:t?{pin_id:t}:void 0,clientTrackingParams:n??void 0})}catch(t){throw l(i,a,e,!1),t}}}let h=(e,t)=>({type:"USER_BULK_FOLLOW",payload:{ids:e,value:t}}),m=e=>t=>{e.length>0&&((0,n.A)({url:"/v3/users/follow/",method:"PUT",data:{followee_ids:e}}).catch(()=>t(h(e,!1))),t(h(e,!0)))}},974694(e,t,r){r.d(t,{Bt:()=>c,Fq:()=>p,LR:()=>a,Wi:()=>h,oH:()=>u,om:()=>d,pV:()=>o,yX:()=>s});var n=r(257300),i=r(805863);function a(e){return{type:"UPDATE_USER_PIN_COUNT",payload:e}}let o=(e,t)=>({type:"USER_FOLLOW",payload:{id:e,value:t}}),s=(e,t)=>({type:"USER_FOLLOWING_COUNT",payload:{id:e,following:t}}),l=(e,t)=>({type:"USER_BLOCK",payload:{id:e,value:t}}),d=({id:e,orbacSubjectId:t,blockSource:r,blockContext:i,logContextEvent:a})=>async o=>{o(l(e,!0));let s=await (0,n.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:e},method:"PUT",data:{orbac_subject_id:t,block_source:r,block_context:i}}).catch(()=>o(l(e,!1)));return a({event_type:54,object_id_str:e}),s},c=(e,t)=>async r=>{r(l(e,!1));let i=await (0,n.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:e},method:"DELETE"}).catch(()=>r(l(e,!0)));return t({event_type:55,object_id_str:e}),i};function u(e){return{type:"UPDATE_USER_SCHEDULED_PIN_COUNT",payload:e}}let p=(e,t)=>()=>(0,n.A)({url:"/v3/users/state/{state}/",urlParams:{state:e},method:"PUT",data:{value:t}}),h=(e,t,r)=>(a,o)=>{(0,n.A)({url:"/v3/users/me/",method:"POST"}).then(()=>{r({event_type:48,object_id_str:o().session.userId}),e(),(0,i.A)()},t)}},623987(e,t,r){r.d(t,{A:()=>i});var n=r(106386);function i({children:e,storyId:t}){let r=(0,n.d4)(({stories:e})=>e[t]);return r&&e(r)}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/12724-0c7d62dfe5d9f4dd.mjs.map